---
title: "Homework 4"
author: "Arden Moser"
date: "`r Sys.Date()`"
output:
  html_document: 
    theme: spacelab
---

## Instructions
Answer the following questions and/or complete the exercises in RMarkdown. Please embed all of your code and push the final work to your repository. Your report should be organized, clean, and run free from errors. Remember, you must remove the `#` for any included code chunks to run. Any plots must have appropriate titles and aesthetics.  

## Load the tidyverse
```{r}
library("tidyverse")
options(scipen = 999) #disable scientific notation
```

For this homework, we will be using the `msleep` dataset from the `ggplot2` package. This dataset contains information about the sleep habits of various mammals. [Reference](https://ggplot2.tidyverse.org/reference/msleep.html): V. M. Savage and G. B. West. A quantitative, theoretical framework for understanding mammalian sleep. Proceedings of the National Academy of Sciences, 104 (3):1051-1056, 2007.

**1. Use a summary function of your choice to get an idea of the structure of the msleep data.**

```{r}
summary(msleep)
```

**2. What are the names of the variables? To get a better idea of what the variables mean, you can use `?msleep`.**

```{r}
?msleep
```
The variables are name (common name of mammal), genus (genus of mammal), vore (carnivore, omnivore or herbivore?), order (order of mammal), conservation (conservation status of mammal), sleep_total (total amount of sleep, in hours), sleep_rem (rem sleep, in hours), sleep_cycle (length of sleep cycle, in hours), awake (amount of time spent awake, in hours), brainwt (brain weight in kilograms), and bodywt (body weight in kilograms)

**3. Make a plot that shows the number of mammals in each vore type. Which vore type is most represented in the data?**
```{r}
ggplot(data = msleep %>% filter(!is.na(vore)), aes(x = vore, fill = vore)) +
  geom_bar() +
  labs(
    title = "Number of Mammals by Vore Type",
    x = "Vore Type",
    y = "Number of Mammals"
  )
```

Herbivores are the most represented in the data due to its bar being the highest out of all the vore types.

**4. What is the average length of time that each mammal sleeps?**
```{r}
summary(msleep$sleep_total)
```
The average length of time of time that each mammal sleeps is about 10 hours.

**5. Use `summary()` to get a quick idea of the range of values for the variable `bodywt`.**
```{r}
summary(msleep$bodywt)
```
The 'bodywt' variable has a range between 6654.000 kg and 0.005 kg.

**6. Build a plot that shows the range of `bodywt.` by vore type. Because the range of `bodywt` is so variable, you will need to scale the y-axis. You do this by adding `scale_y_log10()` as another layer.**
```{r}
ggplot(data = msleep, aes(x = vore, y = bodywt, color = vore)) +
  scale_y_log10() +
  geom_boxplot(na.rm = TRUE) +
  labs(
    title = "Body Weight by Vore Type",
    x = "Vore Type",
    y = "Body Weight (kg)"
  )
```

**7. Is there a relationship between body weight and total sleep time? Add appropriate labels and a title to your plot.**
```{r}
ggplot(data = msleep, aes(x = bodywt, y = sleep_total)) +
  scale_x_log10() +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(
    title = "Body Weight vs Total Sleep Time",
    x = "Body Weight (kg)",
    y = "Total Sleep Time (hr)"
  )
```

There seems to be a negative linear relationship bewteen body weight and total amount of sleep time based on the downwards regression line.

**8. Which vore type tends to sleep the most? Build a plot to support your answer.**
```{r}
ggplot(data = msleep %>% filter(!is.na(vore)), aes(x = vore, y = sleep_total, fill = vore)) +
  geom_boxplot() +
  labs(
    title = "Total Sleep Time by Vore Type",
    x = "Vore Type",
    y = "Total Sleep Time (hr)"
  )
```

Insectivores tend to sleep the most due to its boxplot being mapped higher than that of the other vore types.

**9. Is there a relationship between brain weight and body weight? Build a plot to support your answer.**
```{r}
ggplot(data = msleep, aes(x = brainwt, y = bodywt)) +
  scale_x_log10() +
  scale_y_log10() +
  geom_point(na.rm = TRUE) +
  geom_smooth(method = "lm", na.rm = TRUE) +
  labs(
    title = "Brain Weight vs Body Weight",
    x = "Brain Weight (kg)",
    y = "Body Weight (kg))"
  )
```

There seems to be a positive, linear relationship between brain weight and body weight due to the upwards regression line.

**10. Build one plot of your choice that provides additional insight into the msleep dataset. Be sure to include appropriate labels and a title.**
```{r}
ggplot(data = msleep %>% filter(!is.na(vore)), aes(x = vore, y = awake, fill = vore)) +
  geom_boxplot() +
  labs(
    title = "Time Awake by Vore Type",
    x = "Vore Type",
    y = "Amount of Time Spent Awake (hr)"
  )
```

On average, insectivores spent the least amount of time awake out of all the vore types.

## Knit and Upload
Please knit your work as an .html file and upload to Canvas. Homework is due before the start of the next lab. No late work is accepted. Make sure to use the formatting conventions of RMarkdown to make your report neat and clean!  